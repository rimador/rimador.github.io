let debugLevel=0,VERSIONS_FITXERS={"col_0.txt":"v1","col_1.txt":"v1","col_2.txt":"v1","col_5.txt":"v2","col_6.txt":"v2","col_7.txt":"v1","col_8.txt":"v1","col_9.txt":"v1","col_10.txt":"v1"},Debug={log:3<=debugLevel?e=>console.log("[DEBUG] "+e):()=>{},logError:2<=debugLevel?(...e)=>console.error("[ERROR]",...e):()=>{},logTime:4<=debugLevel?e=>console.time("[TIMER] "+e):()=>{},logTimeEnd:4<=debugLevel?e=>console.timeEnd("[TIMER] "+e):()=>{},contador:1<=debugLevel?e=>console.log("[COUNTER] "+e):()=>{}};3<=debugLevel&&window.addEventListener("DOMContentLoaded",()=>{var e=document.getElementById("botoNetejarCache");e&&(e.style.display="block")});let array0,array1,array2,array5,array6,array7,array8,array9,array10,fitxersLlegits=0,nombresDeFitxers=9,nombresSeleccionats=[0,1,2,5,6,7,8,9,10],camins=nombresSeleccionats.map(e=>`diccionaris/separat/col_${e}.txt`);function obrirIndexedDB(){return new Promise((e,r)=>{let a=indexedDB.open("rimadorDB",1);a.onerror=()=>r(null),a.onsuccess=()=>e(a.result),a.onupgradeneeded=e=>{e=e.target.result;e.objectStoreNames.contains("fitxers")||e.createObjectStore("fitxers",{keyPath:"nom"})}})}function recuperarFitxer(t,s){return new Promise((e,r)=>{let a=t.transaction("fitxers","readonly").objectStore("fitxers").get(s);a.onsuccess=()=>e(a.result),a.onerror=()=>r(null)})}function guardarFitxer(t,s,i,n){return new Promise((e,r)=>{var a=t.transaction("fitxers","readwrite");a.objectStore("fitxers").put({nom:s,contingut:i,versio:n}),a.oncomplete=()=>e(),a.onerror=()=>r()})}async function llegirFitxerAmbIndexedDB(r){var a=r.split("/").pop(),e=VERSIONS_FITXERS[a]||"v1";try{var t=await obrirIndexedDB();if(!t)throw new Error("IndexedDB no disponible");var s=await recuperarFitxer(t,a);if(Debug.log(`Comparant versions: guardada=${s?.versio}, actual=`+e),s&&s.versio===e)return console.log(a+" carregat d'IndexedDB"),fitxersLlegits++,document.getElementById("loader-text2").textContent=`Carregant fitxers (${fitxersLlegits}/${nombresDeFitxers})`,processarFitxerEnParalel(s.contingut);console.log(a+" obsolet o no guardat, fent fetch i guardant arxiu a Indexed");var i=await fetchFitxer(r);return await guardarFitxer(t,a,i,e),Debug.log(a+" guardat a IndexedDB amb nova versió"),fitxersLlegits++,document.getElementById("loader-text2").textContent=`Carregant fitxers (${fitxersLlegits}/${nombresDeFitxers})`,processarFitxerEnParalel(i)}catch(e){Debug.logError(`IndexedDB fallida per ${a}, intentant fetch directe`);s=document.getElementById("error-msg"),t=(s&&(s.textContent=`Problema amb cache. Carregant ${a} manualment.`),await fetchFitxer(r));return fitxersLlegits++,document.getElementById("loader-text2").textContent=`Carregant fitxers (${fitxersLlegits}/${nombresDeFitxers})`,processarFitxerEnParalel(t)}}function processarFitxerEnParalel(r){return new Promise(e=>{setTimeout(()=>{e(processarFitxerDeText(r))},0)})}async function fetchFitxer(e){var r=await fetch(e);if(r.ok)return r.text();throw new Error("Error en llegir "+e)}function processarFitxerDeText(e){return e.split("\n")}function netejarIndexedDB(){var e=indexedDB.deleteDatabase("rimadorDB");e.onsuccess=()=>console.log("IndexedDB esborrat correctament"),e.onerror=()=>console.error("Error en esborrar IndexedDB"),e.onblocked=()=>console.warn("L'esborrat d'IndexedDB està bloquejat")}document.addEventListener("DOMContentLoaded",async()=>{Debug.logTime("Temps de càrrega"),document.getElementById("loader-text2").textContent=`Carregant fitxers (${fitxersLlegits}/${nombresDeFitxers})`;try{var e=await Promise.all(camins.map(llegirFitxerAmbIndexedDB));[array0,array1,array2,array5,array6,array7,array8,array9,array10]=e,console.log("Tots els fitxers carregats correctament"),document.getElementById("loader").style.display="none"}catch(e){Debug.logError("Error en carregar els fitxers:",e),document.getElementById("loader").style.display="none"}finally{Debug.logTimeEnd("Temps de càrrega")}});let inputParaula=document.getElementById("paraulaCercada"),CriterisNoms=(inputParaula.addEventListener("keydown",function(e){"Enter"===e.key&&(e.preventDefault(),realitzarCerca())}),cercaButton.addEventListener("click",realitzarCerca),{...crearCriteris("Noms","N"),...crearCriteris("Propis","NP"),...crearCriteris("Comuns","NC")}),CriterisVerbs={...crearCriteris("Verbs","V"),...crearCriterisTriples("Indicatiu","VAI","VSI","VMI"),...crearCriterisTriples("Subjuntiu","VAS","VSS","VMS"),...crearCriterisTriples("Imperatiu","VAM","VSM","VMM"),...crearCriterisTriples("Gerundis","VAG","VSG","VMG"),...crearCriterisTriples("Participis","VAP","VSP","VMP"),...crearCriterisTriples("Infinitius","VAN","VSN","VMN")},CriterisAdjectius={...crearCriteris("Adjectius","A"),...crearCriteris("Qualificatius","AQ0"),...crearCriteris("Superlatius","AQA"),...crearCriteris("Ordinals","AO")},CriterisPronoms={...crearCriteris("Pronoms","P"),...crearCriteris("Demostratius","PD"),...crearCriteris("Indefinits","PI"),...crearCriteris("Interrogatius / Exclamatius","PT"),...crearCriterisDobles("Personals (forts i febles)","PP","P0"),...crearCriteris("Possessius","PX"),...crearCriteris("Relatius","PR")},CriterisDeterminants={...crearCriteris("Determinants","D"),...crearCriteris("Números","DN"),...crearCriteris("Articles","DA"),...crearCriteris("Relatius","DR"),...crearCriteris("Interrogatius","DT"),...crearCriteris("Demostratius","DD"),...crearCriteris("Exclamatius","DE"),...crearCriteris("Indefinits","DI"),...crearCriteris("Possessius","DP")},CriterisAltres={...crearCriteris("Altres categories","Z"),...crearCriteris("Adverbis","ZR"),...crearCriteris("Conjuncions","ZC"),...crearCriteris("Interjeccions","ZI"),...crearCriteris("Preposicions","ZSPS"),...crearCriteris("Contraccions","ZSP+"),...crearCriteris('"etcètera"',"ZF")};function crearCriteris(e,r){return{[""+e]:{filterFunction:e=>e[2].startsWith(""+r)}}}function crearCriterisDobles(e,r,a){return{[""+e]:{filterFunction:e=>e[2].startsWith(r)||e[2].startsWith(a)}}}function crearCriterisTriples(e,r,a,t){return{[""+e]:{filterFunction:e=>e[2].startsWith(r)||e[2].startsWith(a)||e[2].startsWith(t)}}}async function realitzarCerca(){Debug.log("Botó clicat!"),Debug.logTime("realitzarCerca"),document.getElementById("espai_inicial").style.display="none";try{matches=[];var e=document.getElementById("paraulaCercada").value.trim().toLowerCase(),r=document.getElementById("numeroSelector").value,a=document.getElementById("rimaSelector").value,t=buscarParaula(e,r,document.getElementById("categoriaSelector").value,a,document.getElementById("nomsPropis").value,document.getElementById("plurals").value,array0,array1,array2,array5,array6,array7,array8,array9,array10);matches=t[0],paraulacerca=t[1],matches_provisionals=matches.slice(),actualitzarRimes(),document.querySelectorAll(".clickable-checkbox").forEach(function(e){e.checked=!0}),mostrarTotesLesLlistes(),document.querySelector(".impressio").style.display="flex",Debug.logTimeEnd("realitzarCerca")}catch(e){Debug.logError("Error en realitzar la cerca:",e)}}function buscarParaula(r,a,t,s,i,n,o,c,l,u,d,m,g,p,b){Debug.logTime("buscarParaula");var e=o.findIndex(e=>e.toLowerCase()===r.toLowerCase());llistaParaulaCerca=[o[e],c[e],l[e],u[e],d[e],m[e],g[e],p[e],b[e]],-1==e&&(llistaParaulaCerca=[0,0,0,0,0,0,0,0,0]);for(var h=0;h<o.length;h++){let e=1;for(;1===e&&(m[h]===a||"0"===a||"5"===a)&&!("5"===a&&parseInt(m[h])<5)&&("vocal+h"!==t||"haeiou".includes(o[h][0]))&&("consonant"!==t||!"haeiou".includes(o[h][0]))&&("r.consonant"!==s||u[h]===llistaParaulaCerca[3])&&("r.assonant"!==s||d[h]===llistaParaulaCerca[4])&&("no"!==i||"N"!==l[h][0]||"P"!==l[h][1]);){if("no"===n){if("D"===l[h][0]&&"P"===l[h][4])break;if("A"===l[h][0]&&"P"===l[h][4])break;if("N"===l[h][0]&&"P"===l[h][3])break;if("P"===l[h][0]&&"P"===l[h][4])break}var f=[o[h],c[h],l[h],m[h],g[h],p[h],b[h]];matches.push(f),e=0}}return Debug.logTimeEnd("buscarParaula"),[matches,llistaParaulaCerca]}function crearEnllacViccionari(e){e='<a href="https://ca.wiktionary.org/wiki/'+e+'" target="_blank">';return e+'<img src="./assets/logovicc (240x240).png" loading="lazy" alt="Logo" class="logo">'+"</a>"}function crearEnllacViquipedia(e){e='<a href="https://ca.wikipedia.org/wiki/'+e+'" target="_blank">';return e+'<img src="./assets/logowiki (263x240).png" loading="lazy" alt="Logo" class="logo">'+"</a>"}function crearEnllacDiec(e){e='<a href="https://dlc.iec.cat/Results?DecEntradaText='+e+'&AllInfoMorf=False&OperEntrada=0&OperDef=0&OperEx=0&OperSubEntrada=0&OperAreaTematica=0&InfoMorfType=0&OperCatGram=False&AccentSen=False&CurrentPage=0&refineSearch=0&Actualitzacions=False" target="_blank">';return e+'<img src="./assets/logodiec (200x200).png" loading="lazy" alt="Logo" class="logo">'+"</a>"}function actualitzarRimes(){Debug.logTime("actualitzarRimes");var e="Nombre de rimes: "+matches_provisionals.length,r=(document.getElementById("nombre").innerHTML=e,{}),a="";if(0<matches_provisionals.length){for(var t,s=0;s<matches_provisionals.length;s++){var i=matches_provisionals[s],n=i[0],o="",c=("V"===i[2][0]&&(o=" ("+i[1]+") "),""),l="",u="",i=("Vicc"===i[4]&&(c=crearEnllacViccionari(i[1])),"Viq"===i[5]&&(l=crearEnllacViquipedia(i[1])),"Diec"===i[6]&&(u=crearEnllacDiec(i[1])),i[3]);r[i]||(r[i]=[]),r[i].push({paraula:n,paraula_mare:o,enllac_vicc:c,enllac_viq:l,enllac_diec:u})}for(t in r){a+="<h3><br>"+t+(1<t?" síl·labes":" síl·laba")+":</h3><ul>";for(var d=0;d<r[t].length;d++){var m=r[t][d],g="";m.enllac_vicc&&(g+=m.enllac_vicc+" "),m.enllac_viq&&(g+=m.enllac_viq+" "),m.enllac_diec&&(g+=m.enllac_diec+" "),a+="<li><span class='classeParaula'>"+m.paraula+"</span><span class='classeParaulaMare'>"+m.paraula_mare+"</span> "+g.trim()+"</li>"}a+="</ul>"}}else e=0===paraulacerca[0]?"No s'ha trobat la paraula al diccionari.":"No s'han trobat rimes amb aquestes condicions. Ets massa exigent!",a="<ul><li>"+e+"</li></ul>";document.getElementById("rima_enllac").innerHTML=a,Debug.logTimeEnd("actualitzarRimes")}function mostrarTotesLesLlistes(){Debug.logTime("mostrarTotesLesLlistes");var e=obtenirValorsSegonsPrimerCaracter(matches);mostrarLlista("noms",e.resultatsN,"checkbox1"),mostrarLlista("adjectius",e.resultatsA,"checkbox2"),mostrarLlista("verbs",e.resultatsV,"checkbox3"),mostrarLlista("determinants",e.resultatsD,"checkbox4"),mostrarLlista("pronoms",e.resultatsP,"checkbox5"),mostrarLlista("altres",e.resultatsAlt,"checkbox6"),Debug.logTimeEnd("mostrarTotesLesLlistes")}function mostrarLlista(e,r,a){Debug.logTime("mostrarLlista");var t,e="#"+e+"List",a=document.querySelector("#"+a),e=document.querySelector(e);a&&e?(a.parentElement.style.display=0<r.length?"block":"none",e.style.display=0<r.length?"block":"none",(t=e.querySelectorAll("li")).forEach(function(e,r){e.style.display="none"}),r.forEach(function(e){e<t.length&&(t[e].style.display="list-item")})):Debug.log("No es compleixen les condicions per entrar a la lògica principal"),Debug.logTimeEnd("mostrarLlista")}function toggleList(e,r){Debug.logTime("toggleList");e=document.getElementById(e),r=document.getElementById(r),e=e.querySelectorAll('input[type="checkbox"]');r.checked?e.forEach(function(e){e.checked=!0}):e.forEach(function(e){e.checked=!1}),Debug.logTimeEnd("toggleList")}function handleCheckboxClick(e,a){if(Debug.logTime("handleCheckboxClick"),"checkbox"===e.target.type){var t=e.target.parentNode.innerText.trim();if(t in a){let r=a[t].filterFunction;e.target.checked?(a=matches.filter(r).filter(e=>!matches_provisionals.includes(e)),matches_provisionals=matches_provisionals.concat(a),Debug.log(`Checkbox "${t}" marcada`)):(Debug.log(`Checkbox "${t}" desclicat`),matches_provisionals=matches_provisionals.filter(e=>!r(e))),actualitzarRimes()}}Debug.logTimeEnd("handleCheckboxClick")}function obtenirValorsSegonsPrimerCaracter(e){Debug.logTime("obtenirValorsSegonsPrimerCaracter");for(var r=[],a=[],t=[],s=[],i=[],n=[],o=0;o<e.length;o++){var c=e[o][2],l=c.charAt(0),u=c.charAt(1),d=c.charAt(2);switch(l){case"N":switch(u){case"P":r.push(0);break;case"C":r.push(1)}break;case"A":switch(u){case"Q":switch(d){case"0":a.push(0);break;case"A":a.push(1)}break;case"O":a.push(2)}break;case"V":switch(d){case"I":t.push(0);break;case"S":t.push(1);break;case"M":t.push(2);break;case"G":t.push(3);break;case"P":t.push(4);break;case"N":t.push(5)}break;case"D":switch(u){case"N":s.push(0);break;case"A":s.push(1);break;case"R":s.push(2);break;case"T":s.push(3);break;case"D":s.push(4);break;case"E":s.push(5);break;case"I":s.push(6);break;case"P":s.push(7)}break;case"P":switch(u){case"D":i.push(0);break;case"I":i.push(1);break;case"T":i.push(2);break;case"P":case"0":i.push(3);break;case"X":i.push(4);break;case"R":i.push(5)}break;case"Z":switch(u){case"R":n.push(0);break;case"C":n.push(1);break;case"I":n.push(2);break;case"F":n.push(5)}switch(d){case"S":n.push(3);break;case"+":n.push(4)}}}return Debug.logTimeEnd("obtenirValorsSegonsPrimerCaracter"),{resultatsN:r,resultatsA:a,resultatsV:t,resultatsD:s,resultatsP:i,resultatsAlt:n}}function toggleForm(){var e=document.getElementById("formulariContainer");"none"===e.style.display||""===e.style.display?(e.style.display="block",document.addEventListener("click",closeFormOnClickOutside)):(e.style.display="none",document.removeEventListener("click",closeFormOnClickOutside))}function closeFormOnClickOutside(e){var r=document.getElementById("formulariContainer");r.contains(e.target)||"mostrarFormulari"===e.target.id||(r.style.display="none",document.removeEventListener("click",closeFormOnClickOutside))}window.addEventListener("scroll",function(){var e=document.getElementById("container"),r=document.getElementById("checkboxContainer"),a=document.getElementById("separador_rosa2"),e=e.getBoundingClientRect();120<e.height?(r.style.top=40+e.height+40+"px",a.style.top=40+e.height+"px"):(r.style.top="200px",a.style.top="160px")});
//# sourceMappingURL=script.min.js.map
